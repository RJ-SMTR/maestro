resources:
  basedosdados_config:
    config:
      table_id: onibus_rdo40_registros
      dataset_id: br_rj_riodejaneiro_rdo 
  timezone_config:
    config:
      timezone: "America/Sao_Paulo" 
  discord_webhook:
    config:
      url: "{{ '' | env_override('SPPO_DISCORD_WEBHOOK')}}"
      success_cron: "* * * * *"
solids:
  parse_file_path_and_partitions:
    inputs:
      bucket_path: 
        value: raw/br_rj_riodejaneiro_rdo/onibus_rdo40_registros/ano=2021/mes=01/2021_-_01_-_JANEIRO.csv
  process_csv:
    config:
      delimiter: ","
      header_lines: 1
  upload_to_bigquery:
    inputs:
      modes:
        value:
          - staging
  get_headers:
    inputs:
      original_header:
        value:
          - "Termo"
          - "Linha"
          - "TPSERV"
          - "ORD_SERV"
          - "TPVEIC"
          - "ANO"
          - "MÊS"
          - "DIA"
          - "TARIDET"
          - "TARIFPRA"
          - "FROTDET"
          - "FROTLIC"
          - "FROTOPE"
          - "NUMVIG"
          - "KMCOB"
          - "IDOSO"
          - "PNE"
          - "ESTU"
          - "ESTE"
          - "ESTM"
          - "FUNCEMP"
          - "TOTGRAT"
          - "BUC"
          - "BUCINT"
          - "RECBUC"
          - "BUCS"
          - "BUCSINT"
          - "RECBUCS"
          - "BUTMET"
          - "RECVT"
          - "TOTPASPAG"
          - "RECPASPAG"
          - "TOTPAS"
          - "RECTOTAL"
          - "PASLVRUNI"
      column_mapping:
        value:
            "Termo": "operadora"
            "Linha": "linha"
            "TPSERV": "servico_tipo"
            "ORD_SERV": "servico_termo"
            "TPVEIC": "tipo_veiculo"
            "ANO": "data_ano"
            "MÊS": "data_mes"
            "DIA": "data_dia"
            "TARIDET": "tarifa_codigo"
            "TARIFPRA": "tarifa_valor"
            "FROTDET": "frota_determinada"
            "FROTLIC": "frota_licenciada"
            "FROTOPE": "frota_operante"
            "NUMVIG": "viagem_realizada"
            "KMCOB": "km"
            "IDOSO": "gratuidade_idoso"
            "PNE": "gratuidade_especial"
            "ESTU": "gratuidade_estudante_federal"
            "ESTE": "gratuidade_estudante_estadual"
            "ESTM": "gratuidade_estudante_municipal"
            "FUNCEMP": "gratuidade_rodoviario"
            "PASLVRUNI": "universitario"
            "TOTGRAT": "gratuidade_total"
            "BUC": "buc_1a_perna"
            "BUCINT": "buc_2a_perna"
            "RECBUC": "buc_receita"
            "BUCS": "buc_supervia_1a_perna"
            "BUCSINT": "buc_supervia_2a_perna"
            "RECBUCS": "buc_supervia_receita"
            "BUTMET": "perna_unica_e_outros_transportado"
            "RECVT": "perna_unica_e_outros_receita"
            "TOTPASPAG": "especie_passageiro_transportado"
            "RECPASPAG": "especie_receita"
            "TOTPAS": "total_passageiro_transportado"
            "RECTOTAL": "total_receita"
      ordered_header:
        value:
          - "operadora"
          - "linha"
          - "servico_tipo"
          - "servico_termo"
          - "tipo_veiculo"
          - "data_ano"
          - "data_mes"
          - "data_dia"
          - "tarifa_codigo"
          - "tarifa_valor"
          - "frota_determinada"
          - "frota_licenciada"
          - "frota_operante"
          - "viagem_realizada"
          - "km"
          - "gratuidade_idoso"
          - "gratuidade_especial"
          - "gratuidade_estudante_federal"
          - "gratuidade_estudante_estadual"
          - "gratuidade_estudante_municipal"
          - "gratuidade_rodoviario"
          - "universitario"
          - "gratuidade_total"
          - "buc_1a_perna"
          - "buc_2a_perna"
          - "buc_receita"
          - "buc_supervia_1a_perna"
          - "buc_supervia_2a_perna"
          - "buc_supervia_receita"
          - "perna_unica_e_outros_transportado"
          - "perna_unica_e_outros_receita"
          - "especie_passageiro_transportado"
          - "especie_receita"
          - "total_passageiro_transportado"
          - "total_receita"
          - "tipo_informacao"
  divide_columns:
    inputs:
      cols_to_divide:
        value:
          - "tarifa_valor"
          - "buc_receita"
          - "buc_supervia_receita"
          - "perna_unica_e_outros_receita"
          - "especie_receita"
          - "total_receita"